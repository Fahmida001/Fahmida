"0",""
"0","# Extract proportion of variance explained"
"0","variance_explained <- summary(pca_res)$importance[2, ]  # Second row = proportion of variance"
"0","pc_names <- names(variance_explained)"
"0",""
"0","# Create a data frame for plotting"
"0","var_df <- data.frame("
"0","  PC = pc_names,"
"0","  Variance = variance_explained * 100  # Convert to percentage"
"0",")"
"0",""
"0","# Bar plot of % variance explained"
"0","ggplot(var_df, aes(x = PC, y = Variance)) +"
"0","  geom_bar(stat = ""identity"", fill = ""steelblue"") +"
"0","  labs("
"0","    title = ""Variance Explained by Principal Components"","
"0","    x = ""Principal Component"","
"0","    y = ""% of Variance"""
"0","  ) +"
"0","  theme_minimal()"
"0",""
