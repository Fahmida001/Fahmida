"0",""
"0","# Extract expression matrix (only the columns with expression values)"
"0","expr_matrix <- rna %>%"
"0","  select(P33_1, P33_2, P33_3, P3_1, P3_2, P3_3) %>%"
"0","  as.matrix()"
"0",""
"0","# Transpose the matrix: samples as rows, genes as columns"
"0","expr_t <- t(expr_matrix)"
"0",""
"0","# Perform PCA"
"0","pca_res <- prcomp(expr_t, scale. = TRUE)"
"0",""
"0","# Create a data frame with PCA scores"
"0","pca_df <- as.data.frame(pca_res$x)"
"0",""
"0","# Add sample group labels (in same order as columns in original matrix)"
"0","pca_df$Group <- c(""Trisomic"", ""Trisomic"", ""Trisomic"", ""Disomic"", ""Disomic"", ""Disomic"")"
"0",""
"0","# Plot PCA"
"0","ggplot(pca_df, aes(x = PC1, y = PC2, color = Group)) +"
"0","  geom_point(size = 4) +"
"0","  labs("
"0","    title = ""PCA of Gene Expression: Trisomic vs. Disomic iPSCs"","
"0","    x = paste0(""PC1 ("", round(summary(pca_res)$importance[2, 1] * 100, 1), ""%)""),"
"0","    y = paste0(""PC2 ("", round(summary(pca_res)$importance[2, 2] * 100, 1), ""%)"")"
"0","  ) +"
"0","  theme_minimal()"
