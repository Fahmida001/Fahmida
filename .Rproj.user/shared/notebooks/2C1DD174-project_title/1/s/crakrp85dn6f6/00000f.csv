"0",""
"0","library(tidyverse)"
"0","library(ggrepel)  # for better label positioning"
"0",""
"0","# Step 1: Filter only Chromosome 12 genes"
"0","chr12_genes <- rna %>%"
"0","  filter(chromosome_name == ""12"")"
"0",""
"0","# Step 2: Define thresholds"
"0","log2fc_cutoff <- log2(1.5)"
"0","padj_cutoff <- 0.05"
"0",""
"0","# Step 3: Categorize genes"
"0","chr12_genes <- chr12_genes %>%"
"0","  mutate(Regulation = case_when("
"0","    log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ ""Upregulated"","
"0","    log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ ""Downregulated"","
"0","    TRUE ~ ""Not Significant"""
"0","  ))"
"0",""
"0","# Step 4: Select top 20 up and 20 downregulated genes to label"
"0","top_genes <- chr12_genes %>%"
"0","  filter(Regulation == ""Upregulated"") %>%"
"0","  arrange(pAdj, desc(log2FoldChange)) %>%"
"0","  slice_head(n = 20) %>%"
"0","  bind_rows("
"0","    chr12_genes %>%"
"0","      filter(Regulation == ""Downregulated"") %>%"
"0","      arrange(pAdj, log2FoldChange) %>%"
"0","      slice_head(n = 20)"
"0","  )"
"0",""
"0","# Step 5: Volcano plot with triangles instead of circles"
"0","ggplot(chr12_genes, aes(x = log2FoldChange, y = -log10(pAdj), color = Regulation)) +"
"0","  geom_point(alpha = 0.8, size = 2, shape = 17) +  # triangle shape"
"0","  geom_text_repel("
"0","    data = top_genes,"
"0","    aes(label = gene_symbol),"
"0","    size = 3,"
"0","    box.padding = 0.5,"
"0","    point.padding = 0.3,"
"0","    max.overlaps = Inf,"
"0","    segment.color = ""gray40"""
"0","  ) +"
"0","  scale_color_manual("
"0","    values = c("
"0","      ""Upregulated"" = ""red"","
"0","      ""Downregulated"" = ""blue"","
"0","      ""Not Significant"" = ""gray"""
"0","    )"
"0","  ) +"
"0","  geom_vline(xintercept = c(-log2fc_cutoff, log2fc_cutoff), linetype = ""dashed"", color = ""black"") +"
"0","  geom_hline(yintercept = -log10(padj_cutoff), linetype = ""dashed"", color = ""black"") +"
"0","  labs("
"0","    title = ""Volcano Plot of Chromosome 12 Genes"","
"0","    subtitle = ""Trisomic vs. Disomic iPSCs"","
"0","    x = ""Log2 Fold Change"","
"0","    y = ""-Log10 Adjusted p-value"""
"0","  ) +"
"0","  theme_minimal()"
