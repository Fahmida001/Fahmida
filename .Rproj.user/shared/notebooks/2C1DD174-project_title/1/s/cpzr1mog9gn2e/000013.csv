"0","# Count how many genes are up- or down-regulated"
"0",""
"0","log2fc_cutoff <- log2(1.5)"
"0","padj_cutoff <- 0.05"
"0",""
"0","# Categorize genes"
"0","rna <- rna %>%"
"0","  mutate("
"0","    Regulation = case_when("
"0","      log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ ""Upregulated"","
"0","      log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ ""Downregulated"","
"0","      TRUE ~ ""Not Significant"""
"0","    )"
"0","  )"
"0",""
"0","# Summarize and include all chromosomes (excluding NA)"
"0","reg_summary <- rna %>%"
"0","  filter(Regulation != ""Not Significant"", !is.na(chromosome_name)) %>%"
"0","  count(chromosome_name, Regulation) %>%"
"0","  complete("
"0","    chromosome_name = factor(c(as.character(1:22), ""X"", ""Y""), levels = c(as.character(1:22), ""X"", ""Y"")),"
"0","    Regulation,"
"0","    fill = list(n = 0)"
"0","  )"
"0",""
"0","# Plot"
"0","ggplot(reg_summary, aes(x = chromosome_name, y = n, fill = Regulation)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  labs("
"0","    title = ""Up- and Downregulated Genes per Chromosome"","
"0","    x = ""Chromosome"","
"0","    y = ""Number of Genes"""
"0","  ) +"
"0","  theme_minimal()"
"0",""
