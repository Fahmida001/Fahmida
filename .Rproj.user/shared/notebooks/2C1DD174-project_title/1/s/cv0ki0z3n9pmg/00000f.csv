"0",""
"0","# Step 1: Define thresholds"
"0","log2fc_cutoff <- log2(1.5)"
"0","padj_cutoff <- 0.05"
"0",""
"0","# Step 2: Categorize genes"
"0","rna <- rna %>%"
"0","  mutate("
"0","    Regulation = case_when("
"0","      log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ ""Upregulated"","
"0","      log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ ""Downregulated"","
"0","      TRUE ~ ""Not Significant"""
"0","    )"
"0","  )"
"0",""
"0","# Step 3: Filter out NA chromosome names and define correct chromosome order"
"0","valid_chromosomes <- c(as.character(1:22), ""X"", ""Y"")"
"0",""
"0","# Step 4: Summarize data per chromosome and regulation category"
"0","reg_summary <- rna %>%"
"0","  filter(Regulation != ""Not Significant"", chromosome_name %in% valid_chromosomes) %>%"
"0","  mutate(chromosome_name = factor(chromosome_name, levels = valid_chromosomes)) %>%"
"0","  count(chromosome_name, Regulation) %>%"
"0","  complete(chromosome_name, Regulation, fill = list(n = 0))"
"0",""
"0","# Step 5: Plot"
"0","ggplot(reg_summary, aes(x = chromosome_name, y = n, fill = Regulation)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  labs("
"0","    title = ""Up- and Downregulated Genes in Trisomic vs. Disomic iPSCs by Chromosome"","
"0","    x = ""Chromosome"","
"0","    y = ""Number of Genes"""
"0","  ) +"
"0","  theme_minimal()"
"0",""
