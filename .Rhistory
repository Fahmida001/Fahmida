library(tidyverse)
library(ggrepel)
# Step 1: Filter only Chromosome 12 genes
chr12_genes <- rna %>%
filter(chromosome_name == "12")
# Step 2: Define thresholds
log2fc_cutoff <- log2(1.5)
padj_cutoff <- 0.05
# Step 3: Categorize genes
chr12_genes <- chr12_genes %>%
mutate(Regulation = case_when(
log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ "Upregulated",
log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ "Downregulated",
TRUE ~ "Not Significant"
))
# Step 4: Select clearly visible up/downregulated genes to label
label_genes <- chr12_genes %>%
filter(
(Regulation == "Upregulated" & log2FoldChange > 1 & -log10(pAdj) > 10) |
(Regulation == "Downregulated" & log2FoldChange < -1 & -log10(pAdj) > 10)
)
# Step 5: Volcano plot with gene labels and 3-class legend
ggplot(chr12_genes, aes(x = log2FoldChange, y = -log10(pAdj))) +
geom_point(aes(color = Regulation), alpha = 0.8, size = 2) +
geom_text_repel(
data = label_genes,
aes(label = gene_symbol, color = Regulation),
size = 3,
box.padding = 0.4,
point.padding = 0.3,
max.overlaps = Inf,
segment.color = "gray40",
show.legend = FALSE  # don't duplicate legend entries from text
) +
scale_color_manual(
values = c(
"Upregulated" = "orange",
"Downregulated" = "blue",
"Not Significant" = "gray"
),
breaks = c("Upregulated", "Downregulated", "Not Significant"),
labels = c("Upregulated", "Downregulated", "Not Significant"),
name = NULL
) +
geom_vline(xintercept = c(-log2fc_cutoff, log2fc_cutoff), linetype = "dashed", color = "black") +
geom_hline(yintercept = -log10(padj_cutoff), linetype = "dashed", color = "black") +
labs(
title = "Volcano Plot of Chromosome 12 Genes",
subtitle = "Trisomic vs. Disomic iPSCs",
x = "Log2 Fold Change",
y = "-Log10 Adjusted p-value"
) +
xlim(-2.5, 3) +  # extra space for labels
theme_minimal() +
theme(
legend.position = "right",
legend.text = element_text(size = 10)
)
library(tidyverse)
library(ggrepel)
# Step 1: Filter only Chromosome 12 genes
chr12_genes <- rna %>%
filter(chromosome_name == "12")
# Step 2: Define thresholds
log2fc_cutoff <- log2(1.5)
padj_cutoff <- 0.05
# Step 3: Categorize genes
chr12_genes <- chr12_genes %>%
mutate(Regulation = case_when(
log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ "Upregulated",
log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ "Downregulated",
TRUE ~ "Not Significant"
))
# Step 4: Select clearly visible genes (e.g., far from 0 or very significant)
label_genes <- chr12_genes %>%
filter(
(Regulation == "Upregulated" & log2FoldChange > 1 & -log10(pAdj) > 10) |
(Regulation == "Downregulated" & log2FoldChange < -1 & -log10(pAdj) > 10)
)
# Step 5: Plot with clean 3-category legend
ggplot(chr12_genes, aes(x = log2FoldChange, y = -log10(pAdj))) +
geom_point(aes(color = Regulation), alpha = 0.8, size = 2) +
geom_text_repel(
data = label_genes,
aes(label = gene_symbol),
size = 3,
box.padding = 0.4,
point.padding = 0.3,
max.overlaps = Inf,
segment.color = "gray40"
) +
scale_color_manual(
values = c(
"Upregulated" = "orange",
"Downregulated" = "blue",
"Not Significant" = "gray"
),
breaks = c("Upregulated", "Downregulated", "Not Significant"),  # ensure only these 3
labels = c("Upregulated", "Downregulated", "Not Significant"),
name = NULL  # optional: remove legend title
) +
geom_vline(xintercept = c(-log2fc_cutoff, log2fc_cutoff),
linetype = "dashed", color = "black") +
geom_hline(yintercept = -log10(padj_cutoff),
linetype = "dashed", color = "black") +
labs(
title = "Volcano Plot of Chromosome 12 Genes",
subtitle = "Trisomic vs. Disomic iPSCs",
x = "Log2 Fold Change",
y = "-Log10 Adjusted p-value"
) +
xlim(-2.5, 3) +  # extra space on right
theme_minimal() +
theme(
legend.position = "right",
legend.text = element_text(size = 10)
)
library(tidyverse)
library(ggrepel)
# Step 1: Filter only Chromosome 12 genes
chr12_genes <- rna %>%
filter(chromosome_name == "12")
# Step 2: Define thresholds
log2fc_cutoff <- log2(1.5)
padj_cutoff <- 0.05
# Step 3: Categorize genes
chr12_genes <- chr12_genes %>%
mutate(Regulation = case_when(
log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ "Upregulated",
log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ "Downregulated",
TRUE ~ "Not Significant"
))
# Step 4: Select clearly visible up/downregulated genes to label
label_genes <- chr12_genes %>%
filter(
(Regulation == "Upregulated" & log2FoldChange > 1 & -log10(pAdj) > 10) |
(Regulation == "Downregulated" & log2FoldChange < -1 & -log10(pAdj) > 10)
)
# Step 5: Plot with labels and clean legend
ggplot(chr12_genes, aes(x = log2FoldChange, y = -log10(pAdj))) +
geom_point(aes(color = Regulation), alpha = 0.8, size = 2) +
geom_text_repel(
data = label_genes,
aes(label = gene_symbol, color = Regulation),
size = 3,
box.padding = 0.4,
point.padding = 0.3,
max.overlaps = Inf,
segment.color = "gray40",
show.legend = FALSE
) +
scale_color_manual(
values = c(
"Upregulated" = "orange",
"Downregulated" = "blue",
"Not Significant" = "gray"
),
breaks = c("Upregulated", "Downregulated", "Not Significant"),
labels = c("Upregulated", "Downregulated", "Not Significant"),
name = NULL
) +
geom_vline(xintercept = c(-log2fc_cutoff, log2fc_cutoff),
linetype = "dashed", color = "black") +
geom_hline(yintercept = -log10(padj_cutoff),
linetype = "dashed", color = "black") +
labs(
title = "Volcano Plot of Chromosome 12 Genes",
subtitle = "Trisomic vs. Disomic iPSCs",
x = "Log2 Fold Change",
y = "-Log10 Adjusted p-value"
) +
xlim(-1.5, 3) +  # tighter left margin
theme_minimal() +
theme(
legend.position = "right",
legend.text = element_text(size = 10)
)
library(tidyverse)
library(ggrepel)
# Step 1: Filter only Chromosome 12 genes
chr12_genes <- rna %>%
filter(chromosome_name == "12")
# Step 2: Define thresholds
log2fc_cutoff <- log2(1.5)
padj_cutoff <- 0.05
# Step 3: Categorize genes
chr12_genes <- chr12_genes %>%
mutate(Regulation = case_when(
log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ "Upregulated",
log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ "Downregulated",
TRUE ~ "Not Significant"
))
# Step 4: Select label-worthy genes
label_genes <- chr12_genes %>%
filter(
(Regulation == "Upregulated" & log2FoldChange > 1.25 & -log10(pAdj) > 10) |
(Regulation == "Downregulated" & log2FoldChange < -1 & -log10(pAdj) > 10)
)
# Step 5: Volcano Plot
ggplot(chr12_genes, aes(x = log2FoldChange, y = -log10(pAdj))) +
geom_point(aes(color = Regulation), alpha = 0.8, size = 2) +
geom_text_repel(
data = label_genes,
aes(label = gene_symbol, color = Regulation),
size = 3,
box.padding = 0.4,
point.padding = 0.3,
segment.color = "gray40",
max.overlaps = Inf,
show.legend = FALSE
) +
scale_color_manual(
values = c(
"Upregulated" = "orange",
"Downregulated" = "blue",
"Not Significant" = "gray"
),
breaks = c("Upregulated", "Downregulated", "Not Significant"),
name = NULL
) +
geom_vline(xintercept = c(-log2fc_cutoff, log2fc_cutoff), linetype = "dashed", color = "black") +
geom_hline(yintercept = -log10(padj_cutoff), linetype = "dashed", color = "black") +
labs(
title = "Volcano Plot of Chromosome 12 Genes",
subtitle = "Trisomic vs. Disomic iPSCs",
x = "Log2 Fold Change",
y = "-Log10 Adjusted p-value"
) +
xlim(-1.25, 3) +
theme_minimal() +
theme(
legend.position = "right",
legend.text = element_text(size = 10)
)
library(tidyverse)
library(ggrepel)
# Step 1: Filter Chromosome 12 genes
chr12_genes <- rna %>%
filter(chromosome_name == "12")
# Step 2: Define thresholds
log2fc_cutoff <- log2(1.5)
padj_cutoff <- 0.05
# Step 3: Categorize genes
chr12_genes <- chr12_genes %>%
mutate(Regulation = case_when(
log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ "Upregulated",
log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ "Downregulated",
TRUE ~ "Not Significant"
))
# Step 4: Select labelable genes
label_genes <- chr12_genes %>%
filter(
(Regulation == "Upregulated" & log2FoldChange > 1.25 & -log10(pAdj) > 10) |
(Regulation == "Downregulated" & log2FoldChange < -1 & -log10(pAdj) > 10)
)
# Step 5: Plot with proper label segments
ggplot(chr12_genes, aes(x = log2FoldChange, y = -log10(pAdj))) +
geom_point(aes(color = Regulation), alpha = 0.8, size = 2) +
geom_text_repel(
data = label_genes,
aes(label = gene_symbol, color = Regulation),
size = 3,
box.padding = 0.5,
point.padding = 0.2,
max.overlaps = Inf,
segment.color = "gray40",
segment.size = 0.4,
min.segment.length = 0,
force = 1.5,                # Force repulsion
nudge_y = 2                 # Spread upward
) +
scale_color_manual(
values = c(
"Upregulated" = "orange",
"Downregulated" = "blue",
"Not Significant" = "gray"
),
breaks = c("Upregulated", "Downregulated", "Not Significant"),
name = NULL
) +
geom_vline(xintercept = c(-log2fc_cutoff, log2fc_cutoff), linetype = "dashed", color = "black") +
geom_hline(yintercept = -log10(padj_cutoff), linetype = "dashed", color = "black") +
labs(
title = "Volcano Plot of Chromosome 12 Genes",
subtitle = "Trisomic vs. Disomic iPSCs",
x = "Log2 Fold Change",
y = "-Log10 Adjusted p-value"
) +
xlim(-1.25, 3) +
theme_minimal() +
theme(
legend.position = "right",
legend.text = element_text(size = 10)
)
# Step 1: Filter only Chromosome 12 genes
chr12_genes <- rna %>%
filter(chromosome_name == "12")
# Step 2: Define thresholds
log2fc_cutoff <- log2(1.5)
padj_cutoff <- 0.05
# Step 3: Categorize genes
chr12_genes <- chr12_genes %>%
mutate(Regulation = case_when(
log2FoldChange >= log2fc_cutoff & pAdj < padj_cutoff ~ "Upregulated",
log2FoldChange <= -log2fc_cutoff & pAdj < padj_cutoff ~ "Downregulated",
TRUE ~ "Not Significant"
))
# Step 4: Volcano plot
ggplot(chr12_genes, aes(x = log2FoldChange, y = -log10(pAdj), color = Regulation)) +
geom_point(alpha = 0.8, size = 2) +
scale_color_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue", "Not Significant" = "gray")) +
geom_vline(xintercept = c(-log2fc_cutoff, log2fc_cutoff), linetype = "dashed", color = "black") +
geom_hline(yintercept = -log10(padj_cutoff), linetype = "dashed", color = "black") +
labs(
title = "Volcano Plot of Chromosome 12 Genes",
subtitle = "Trisomic vs. Disomic iPSCs",
x = "Log2 Fold Change",
y = "-Log10 Adjusted p-value"
) +
theme_minimal()
# Top 10 upregulated genes
top_up <- chr12_genes %>%
filter(Regulation == "Upregulated") %>%
arrange(pAdj, desc(log2FoldChange)) %>%
slice_head(n = 10)
# Top 10 downregulated genes
top_down <- chr12_genes %>%
filter(Regulation == "Downregulated") %>%
arrange(pAdj, log2FoldChange) %>%
slice_head(n = 10)
# Combine into one table
top_genes_table <- bind_rows(
top_up %>% mutate(Direction = "Upregulated"),
top_down %>% mutate(Direction = "Downregulated")
) %>%
select(gene_symbol, log2FoldChange, pAdj, Direction)
# Print the table
top_genes_table
library(ggplot2)
# Reorder factor to plot from largest to smallest log2FC
top_genes_plot <- top_genes_table %>%
mutate(gene_symbol = fct_reorder(gene_symbol, log2FoldChange))
ggplot(top_genes_plot, aes(x = gene_symbol, y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = TRUE) +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top 10 Upregulated and Downregulated Chromosome 12 Genes",
x = "Gene Symbol",
y = "Log2 Fold Change"
) +
theme_minimal()
library(ggplot2)
library(forcats)
library(dplyr)
# Filter out genes with names starting with "ENSG" (i.e., unmapped Ensembl IDs)
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%             # remove unannotated Ensembl IDs
mutate(gene_symbol = fct_reorder(gene_symbol, log2FoldChange))  # reorder for plotting
# Plot
ggplot(top_genes_plot, aes(x = gene_symbol, y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = TRUE) +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top 10 Upregulated and Downregulated Chromosome 12 Genes",
x = "Gene Symbol",
y = "Log2 Fold Change"
) +
theme_minimal()
library(ggplot2)
library(forcats)
library(dplyr)
# Filter out genes with names starting with "ENSG" (i.e., unmapped Ensembl IDs)
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%             # remove unannotated Ensembl IDs
mutate(gene_symbol = fct_reorder(gene_symbol, log2FoldChange))  # reorder for plotting
# Plot
ggplot(top_genes_plot, aes(x = gene_symbol, y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = TRUE) +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top Upregulated and Downregulated Chromosome 12 Genes",
x = "Gene Symbol",
y = "Log2 Fold Change"
) +
theme_minimal()
library(ggplot2)
library(forcats)
library(dplyr)
# Filter to remove unmapped Ensembl IDs and keep top 15 by absolute log2FC
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%                     # remove unmapped genes
slice_max(order_by = abs(log2FoldChange), n = 15) %>%        # select top 15
mutate(gene_symbol = fct_reorder(gene_symbol, log2FoldChange))  # reorder for plotting
# Plot
ggplot(top_genes_plot, aes(x = gene_symbol, y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = TRUE) +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top Up- and Downregulated Chr 12 Genes in trisomic iPSCs compared to disomic iPSCs",
x = "Gene Symbol",
y = "Log2 Fold Change"
) +
theme_minimal()
library(ggplot2)
library(forcats)
library(dplyr)
# Filter out genes with names starting with "ENSG" (i.e., unmapped Ensembl IDs)
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%             # remove unannotated Ensembl IDs
mutate(gene_symbol = fct_reorder(gene_symbol, log2FoldChange))  # reorder for plotting
# Plot
ggplot(top_genes_plot, aes(x = gene_symbol, y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = TRUE) +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top Upregulated and Downregulated Chromosome 12 Genes",
x = "Gene Symbol",
y = "Log2 Fold Change"
) +
theme_minimal()
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%
slice_max(order_by = abs(log2FoldChange), n = 15)
ggplot(top_genes_plot, aes(x = fct_reorder(gene_symbol, log2FoldChange), y = log2FoldChange, color = Direction)) +
geom_segment(aes(xend = gene_symbol, y = 0, yend = log2FoldChange), size = 1) +
geom_point(size = 4) +
coord_flip() +
scale_color_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top 15 Up/Downregulated Genes (Chr 12)",
x = "Gene Symbol", y = "Log2 Fold Change"
) +
theme_minimal()
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%
group_by(Direction) %>%
slice_max(order_by = abs(log2FoldChange), n = 15) %>%
ungroup()
ggplot(top_genes_plot, aes(x = fct_reorder(gene_symbol, log2FoldChange), y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = FALSE) +
facet_wrap(~Direction, scales = "free_y") +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top 15 Up- and Downregulated Genes (Chr 12)",
x = "Gene Symbol", y = "Log2 Fold Change"
) +
theme_minimal()
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%
group_by(Direction) %>%
slice_max(order_by = abs(log2FoldChange), n = 15) %>%
ungroup()
ggplot(top_genes_plot, aes(x = fct_reorder(gene_symbol, log2FoldChange), y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = FALSE) +
facet_wrap(~Direction, scales = "free_y") +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top 15 Up- and Downregulated Genes (Chr 12)",
x = "Gene Symbol", y = "Log2 Fold Change"
) +
theme_minimal()
library(ggalt)
library(forcats)
library(dplyr)
# Filter out genes with names starting with "ENSG" (i.e., unmapped Ensembl IDs)
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%             # remove unannotated Ensembl IDs
mutate(gene_symbol = fct_reorder(gene_symbol, log2FoldChange))  # reorder for plotting
# Plot
ggplot(top_genes_plot, aes(x = gene_symbol, y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = TRUE) +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top Upregulated and Downregulated Chromosome 12 Genes",
x = "Gene Symbol",
y = "Log2 Fold Change"
) +
theme_minimal()
library(forcats)
library(dplyr)
# Filter out genes with names starting with "ENSG" (i.e., unmapped Ensembl IDs)
top_genes_plot <- top_genes_table %>%
filter(!grepl("^ENSG", gene_symbol)) %>%             # remove unannotated Ensembl IDs
mutate(gene_symbol = fct_reorder(gene_symbol, log2FoldChange))  # reorder for plotting
# Plot
ggplot(top_genes_plot, aes(x = gene_symbol, y = log2FoldChange, fill = Direction)) +
geom_col(show.legend = TRUE) +
coord_flip() +
scale_fill_manual(values = c("Upregulated" = "magenta", "Downregulated" = "blue")) +
labs(
title = "Top Upregulated and Downregulated Chr-12 Trisomic iPSC Genes",
x = "Gene Symbol",
y = "Log2 Fold Change"
) +
theme_minimal()
# Load necessary libraries
library(tidyverse)
library(forcats)
library(dplyr)
library(clusterProfiler)
# Load necessary libraries
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("clusterProfiler")
